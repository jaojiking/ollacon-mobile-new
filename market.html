<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì œí’ˆ êµí™˜ ë§ˆì¼“ - OllaCon</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"> 
    <style>
        /* íŒì—… ê´€ë ¨ CSS: display:none ìƒíƒœë¥¼ active í´ë˜ìŠ¤ë¡œ ì œì–´ */

        /* ê²°ì œ íŒì—… ì»¨í…Œì´ë„ˆ */
        .payment-popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            display: flex; /* flexë¡œ ë³€ê²½í•˜ì—¬ ë‚´ë¶€ ìš”ì†Œë¥¼ ì¤‘ì•™ì— ë°°ì¹˜ ì¤€ë¹„ */
            justify-content: center;
            align-items: flex-end; /* í™”ë©´ í•˜ë‹¨ì— íŒì—…ì´ ë‚˜íƒ€ë‚˜ë„ë¡ ì„¤ì • */
            z-index: 1000;
            opacity: 0; /* ì´ˆê¸° íˆ¬ëª…í•˜ê²Œ ì„¤ì • */
            visibility: hidden; /* ì´ˆê¸° ìˆ¨ê¹€ ìƒíƒœ */
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        /* íŒì—… í™œì„±í™” ì‹œ */
        .payment-popup.active {
            opacity: 1;
            visibility: visible;
        }

        /* íŒì—… ë‚´ìš© */
        .payment-content {
            background: white;
            width: 100%;
            max-width: 450px; /* ëª¨ë°”ì¼ ìµœëŒ€ ë„ˆë¹„ */
            padding: 20px 20px 40px 20px;
            border-top-left-radius: 15px;
            border-top-right-radius: 15px;
            box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.2);
            transform: translateY(100%); /* ì´ˆê¸° ìœ„ì¹˜: í™”ë©´ ë°– */
            transition: transform 0.3s ease-out;
        }
        
        /* íŒì—… ë³´ì¼ ë•Œ */
        .payment-popup.active .payment-content {
            transform: translateY(0);
        }

        /* ê¸°íƒ€ ìŠ¤íƒ€ì¼ (ì´ì „ê³¼ ë™ì¼) */
        .payment-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        .payment-header h3 {
            margin: 0;
            font-size: 18px;
        }
        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            color: #aaa;
            cursor: pointer;
        }
        .payment-info p {
            margin: 5px 0;
            font-size: 15px;
            color: #555;
        }
        .payment-amount {
            font-size: 24px;
            font-weight: 700;
            color: #f9634d; /* ê°•ì¡°ìƒ‰ */
            margin: 10px 0 25px 0;
        }
        .payment-methods {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }
        .method-btn {
            background: #f7f7f7;
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 8px;
            font-size: 16px;
            text-align: left;
            cursor: pointer;
            transition: background-color 0.2s;
            display: flex;
            align-items: center;
        }
        .method-btn:hover {
            background: #f0f0f0;
        }
        .method-btn.selected {
            border: 2px solid #f9634d;
            background: #fffafa;
        }
        .confirm-payment-btn {
            width: 100%;
            padding: 15px;
            background-color: #f9634d; /* ë©”ì¸ ë²„íŠ¼ ìƒ‰ìƒ í†µì¼ */
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 700;
            margin-top: 25px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="app-container">
        
        <header class="header exchange-header">
            <div class="header-content">
                <i class="fas fa-arrow-left header-icon" onclick="window.history.back();" style="margin-left: 0; opacity: 1;"></i>
                <span class="logo page-title" onclick="window.location.href='index.html';" style="cursor: pointer;">ì œí’ˆê¶Œ êµí™˜ ë§ˆì¼“</span>
                <div class="header-icons-right"></div>
            </div>
            <div class="alert-bar" style="background-color: #e3f2fd; color: #1e88e5; border: 1px solid #bbdefb;">
                <i class="fas fa-info-circle"></i>
                <span style="font-weight: 700;">[êµí™˜ ì •ì±…]</span> **ê¸ˆì•¡ê¶Œë³´ë‹¤ ë†’ì€ ê°€ê²©**ì˜ ì œí’ˆ ì¤‘ **ì°¨ì•¡ 5,000ì› ë¯¸ë§Œ** ì œí’ˆë§Œ êµí™˜ ê°€ëŠ¥í•©ë‹ˆë‹¤.
            </div>
        </header>
        
        <main class="main-content market-content">

            <div class="carousel-container">
                <div class="carousel" id="marketCarousel">
                    <div class="carousel-item" style="background: linear-gradient(45deg, #1abc9c, #16a085);">
                        <p class="carousel-text">âœ… 1ë§Œì›ê¶Œ: 10,001ì› ~ 15,000ì› ì œí’ˆ êµí™˜</p>
                        <p class="carousel-subtext">3,000ì› ì¶”ê°€ ê²°ì œ ì‹œ 13,000ì› ì œí’ˆ êµí™˜ ê°€ëŠ¥</p>
                    </div>
                    <div class="carousel-item" style="background: linear-gradient(45deg, #3498db, #2980b9);">
                        <p class="carousel-text">âœ… 3ë§Œì›ê¶Œ: 30,001ì› ~ 35,000ì› ì œí’ˆ êµí™˜</p>
                        <p class="carousel-subtext">ìµœëŒ€ 5,000ì› ì¶”ê°€ ê²°ì œë¡œ ìƒí’ˆ ì„ íƒì˜ í­ì„ ë„“íˆì„¸ìš”!</p>
                    </div>
                    <div class="carousel-item" style="background: linear-gradient(45deg, #9b59b6, #8e44ad);">
                        <p class="carousel-text">ğŸš« ê¸ˆì•¡ê¶Œë³´ë‹¤ ë‚®ì€ ê°€ê²© ì œí’ˆì€ êµí™˜ ë¶ˆê°€í•©ë‹ˆë‹¤.</p>
                        <p class="carousel-subtext">ì •ì±…ì„ í™•ì¸ í›„ ì‹ ì¤‘í•˜ê²Œ ìƒí’ˆì„ ì„ íƒí•´ ì£¼ì„¸ìš”.</p>
                    </div>
                </div>
                <div class="carousel-indicators" id="carouselIndicators">
                    <span class="dot active"></span>
                    <span class="dot"></span>
                    <span class="dot"></span>
                </div>
            </div>

            <div class="category-scroll">
                <div class="category-item active">ì „ì²´</div>
                <div class="category-item">ì‹í’ˆ/ì™¸ì‹</div>
                <div class="category-item">ì»¤í”¼/ìŒë£Œ</div>
                <div class="category-item">í¸ì˜ì </div>
                <div class="category-item">ì‡¼í•‘/ì¡í™”</div>
                <div class="category-item">ë””ì§€í„¸</div>
            </div>
            
            <div class="product-grid">
                <div class="product-card" onclick="openPaymentPopup('ë§¥ë„ë‚ ë“œ í–„ë²„ê±° ì„¸íŠ¸', 13500, 10000);">
                    <div class="product-image-placeholder">
                        <span class="image-tag" style="background-color: #f39c12;">1ë§Œì›ê¶Œ êµí™˜</span>
                        <i class="fas fa-utensils"></i>
                    </div>
                    <div class="product-info">
                        <p class="product-name">ë§¥ë„ë‚ ë“œ í–„ë²„ê±° ì„¸íŠ¸</p>
                        <p class="product-price">13,500ì›</p>
                    </div>
                </div>

                <div class="product-card" onclick="openPaymentPopup('CGV ì˜í™” ê´€ëŒê¶Œ', 14900, 10000);">
                    <div class="product-image-placeholder">
                        <span class="image-tag" style="background-color: #2ecc71;">1ë§Œì›ê¶Œ êµí™˜</span>
                        <i class="fas fa-ticket-alt"></i>
                    </div>
                    <div class="product-info">
                        <p class="product-name">CGV ì˜í™” ê´€ëŒê¶Œ</p>
                        <p class="product-price">14,900ì›</p>
                    </div>
                </div>

                <div class="product-card" onclick="openPaymentPopup('ìŠ¤íƒ€ë²…ìŠ¤ ì„¸íŠ¸ êµí™˜ê¶Œ', 12500, 10000);">
                    <div class="product-image-placeholder">
                        <span class="image-tag" style="background-color: #34495e;">1ë§Œì›ê¶Œ êµí™˜</span>
                        <i class="fas fa-coffee"></i>
                    </div>
                    <div class="product-info">
                        <p class="product-name">ìŠ¤íƒ€ë²…ìŠ¤ ì„¸íŠ¸ êµí™˜ê¶Œ</p>
                        <p class="product-price">12,500ì›</p>
                    </div>
                </div>

                <div class="product-card" onclick="openPaymentPopup('ë¸Œëœë“œ ì˜ë¥˜ ìƒí’ˆê¶Œ', 32000, 30000);">
                    <div class="product-image-placeholder">
                        <span class="image-tag" style="background-color: #e74c3c;">3ë§Œì›ê¶Œ êµí™˜</span>
                        <i class="fas fa-shopping-bag"></i>
                    </div>
                    <div class="product-info">
                        <p class="product-name">ë¸Œëœë“œ ì˜ë¥˜ ìƒí’ˆê¶Œ</p>
                        <p class="product-price">32,000ì›</p>
                    </div>
                </div>
                
                <div class="product-card" onclick="openPaymentPopup('ìŠ¤ë§ˆíŠ¸í° ì¶©ì „ê¸° ì„¸íŠ¸', 54500, 50000);">
                    <div class="product-image-placeholder">
                        <span class="image-tag" style="background-color: #9b59b6;">5ë§Œì›ê¶Œ êµí™˜</span>
                        <i class="fas fa-plug"></i>
                    </div>
                    <div class="product-info">
                        <p class="product-name">ìŠ¤ë§ˆíŠ¸í° ì¶©ì „ê¸° ì„¸íŠ¸</p>
                        <p class="product-price">54,500ì›</p>
                    </div>
                </div>
                
                <div class="product-card" onclick="openPaymentPopup('ë„ë¯¸ë…¸í”¼ì ì„¸íŠ¸', 33000, 30000);">
                    <div class="product-image-placeholder">
                        <span class="image-tag" style="background-color: #1abc9c;">3ë§Œì›ê¶Œ êµí™˜</span>
                        <i class="fas fa-pizza-slice"></i>
                    </div>
                    <div class="product-info">
                        <p class="product-name">ë„ë¯¸ë…¸í”¼ì ì„¸íŠ¸</p>
                        <p class="product-price">33,000ì›</p>
                    </div>
                </div>

            </div>

        </main>

        <footer class="tab-bar">
            <div class="tab-item" onclick="window.location.href='index.html';"><i class="fas fa-home"></i><p>í™ˆ</p></div>
            <div class="tab-item active"><i class="fas fa-store"></i><p>ì œí’ˆ êµí™˜ê¶Œ</p></div>
            <div class="tab-item" onclick="window.location.href='wallet.html';"><i class="fas fa-wallet"></i><p>ë‚´ ì§€ê°‘</p></div>
            <div class="tab-item" onclick="window.location.href='mypage.html';"><i class="fas fa-user-circle"></i><p>ë§ˆì´í˜ì´ì§€</p></div>
        </footer>

    </div>

    <div id="paymentPopup" class="payment-popup">
        <div class="payment-content">
            <div class="payment-header">
                <h3 id="popupTitle">ì¶”ê°€ ê²°ì œ ì§„í–‰</h3>
                <button class="close-btn" onclick="closePaymentPopup()">&times;</button>
            </div>
            
            <div class="payment-info">
                <p>ìƒí’ˆ: <strong id="productName"></strong></p>
                <p>ìƒí’ˆ ê°€ê²©: <span id="productPrice"></span>ì›</p>
                <p>ë³´ìœ  ê¸ˆì•¡ê¶Œ ì ìš©: <span id="ollaConUsed"></span>ì›</p>
                <div style="border-top: 1px dashed #eee; margin: 10px 0;"></div>
                <p>ì¶”ê°€ ê²°ì œ í•„ìš” ê¸ˆì•¡:</p>
                <div class="payment-amount" id="requiredPayment">3,500ì›</div>
            </div>

            <p style="font-weight: 600; margin-bottom: 10px;">ê²°ì œ ìˆ˜ë‹¨ ì„ íƒ</p>
            
            <div class="payment-methods">
                <button class="method-btn" data-method="credit" onclick="selectPaymentMethod(this)">
                    <i class="fas fa-credit-card" style="color: #f9634d;"></i> ì‹ ìš©ì¹´ë“œ ê²°ì œ
                </button>
                <button class="method-btn" data-method="check" onclick="selectPaymentMethod(this)">
                    <i class="fas fa-credit-card" style="color: #4a90e2;"></i> ì²´í¬ì¹´ë“œ ê²°ì œ
                </button>
                <button class="method-btn" data-method="cash" onclick="selectPaymentMethod(this)">
                    <i class="fas fa-money-bill-wave" style="color: #1abc9c;"></i> í˜„ê¸ˆ ê²°ì œ (ê³„ì¢Œì´ì²´)
                </button>
            </div>
            
            <button class="confirm-payment-btn" onclick="processPayment()">
                3,500ì› ì¶”ê°€ ê²°ì œ ì§„í–‰
            </button>
        </div>
    </div>
    
    <script src="app.js"></script>
    <script>
        // ë§ˆì¼“ í˜ì´ì§€ ë° íŒì—… ì œì–´ JavaScript
        
        // ìºëŸ¬ì…€ ê¸°ëŠ¥ (ê¸°ì¡´ ì½”ë“œ ìœ ì§€)
        const carousel = document.getElementById('marketCarousel');
        const indicators = document.getElementById('carouselIndicators').children;
        const totalSlides = carousel.children.length;

        carousel.addEventListener('scroll', () => {
            const scrollLeft = carousel.scrollLeft;
            const itemWidth = carousel.children[0].offsetWidth + 10;
            let activeIndex = Math.round(scrollLeft / itemWidth);
            activeIndex = Math.min(Math.max(0, activeIndex), totalSlides - 1);

            for (let i = 0; i < totalSlides; i++) {
                indicators[i].classList.remove('active');
            }
            indicators[activeIndex].classList.add('active');
        });

        // íŒì—… ì œì–´ ë³€ìˆ˜
        const popup = document.getElementById('paymentPopup');
        let currentProductName = "";
        let currentRequiredAmount = 0;
        let selectedMethod = null;

        /**
         * íŒì—…ì„ ì—´ê³  ìƒí’ˆ ì •ë³´ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
         * @param {string} name ìƒí’ˆëª…
         * @param {number} price ìƒí’ˆ ê°€ê²© (ì›)
         * @param {number} ollaConValue ì ìš©í•  ì˜¬ë¼ì½˜ ê¸ˆì•¡ê¶Œ ê°€ì¹˜ (ì›)
         */
        function openPaymentPopup(name, price, ollaConValue) {
            const requiredAmount = price - ollaConValue;
            
            // 1. ìƒí’ˆ ê°€ê²©ì´ ê¸ˆì•¡ê¶Œë³´ë‹¤ ë‚®ê±°ë‚˜ ê°™ì„ ê²½ìš° (requiredAmount <= 0) -> êµí™˜ ë¶ˆê°€
            if (requiredAmount <= 0) {
                 alert(`[êµí™˜ ë¶ˆê°€ ì •ì±…] ìƒí’ˆ ê°€ê²© ${price.toLocaleString()}ì›ì´ ê¸ˆì•¡ê¶Œ ${ollaConValue.toLocaleString()}ì› ë³´ë‹¤ ë‚®ê±°ë‚˜ ê°™ìœ¼ë¯€ë¡œ, êµí™˜ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.\n\nì˜¤ì§ ê¸ˆì•¡ê¶Œë³´ë‹¤ ë†’ì€ ê°€ê²©(ì°¨ì•¡ 5,000ì› ë¯¸ë§Œ)ì˜ ì œí’ˆë§Œ êµí™˜ ê°€ëŠ¥í•©ë‹ˆë‹¤.`);
                 return;
            }
            
            // 2. ì°¨ì•¡ì´ 5000ì› ì´ˆê³¼ì¸ ê²½ìš° (requiredAmount > 5000) -> êµí™˜ ë¶ˆê°€
            if (requiredAmount > 5000) {
                 alert(`[êµí™˜ ë¶ˆê°€ ì •ì±…] í•´ë‹¹ ìƒí’ˆì€ ê¸ˆì•¡ê¶Œ(${ollaConValue.toLocaleString()}ì›)ìœ¼ë¡œ êµí™˜ ê°€ëŠ¥í•œ ì°¨ì•¡ 5,000ì›ì„ ì´ˆê³¼í•©ë‹ˆë‹¤. (í˜„ì¬ ì°¨ì•¡: ${requiredAmount.toLocaleString()}ì›)`);
                 return;
            }
            
            // 3. ì¶”ê°€ ê²°ì œ í•„ìš”í•œ ê²½ìš° (0ì› < requiredAmount <= 5000ì›) -> íŒì—… ì‹¤í–‰
            currentProductName = name;
            currentRequiredAmount = requiredAmount;

            // íŒì—… DOM ìš”ì†Œ ì—…ë°ì´íŠ¸
            document.getElementById('productName').textContent = name;
            document.getElementById('productPrice').textContent = price.toLocaleString();
            document.getElementById('ollaConUsed').textContent = ollaConValue.toLocaleString();
            document.getElementById('requiredPayment').textContent = requiredAmount.toLocaleString() + 'ì›';
            
            const confirmBtn = document.querySelector('.confirm-payment-btn');
            confirmBtn.textContent = requiredAmount.toLocaleString() + 'ì› ì¶”ê°€ ê²°ì œ ì§„í–‰';
            confirmBtn.disabled = true; // ê²°ì œ ìˆ˜ë‹¨ ì„ íƒ ì „ê¹Œì§€ ë¹„í™œì„±í™”
            
            // íŒì—… ì—´ê¸°
            popup.classList.add('active');
        }

        function closePaymentPopup() {
            popup.classList.remove('active');
            selectedMethod = null;
            // ëª¨ë“  ë²„íŠ¼ ì„ íƒ í•´ì œ
            document.querySelectorAll('.method-btn').forEach(btn => btn.classList.remove('selected'));
            document.querySelector('.confirm-payment-btn').disabled = true;
        }

        function selectPaymentMethod(button) {
            // ëª¨ë“  ë²„íŠ¼ì˜ ì„ íƒ ìƒíƒœ í•´ì œ
            document.querySelectorAll('.method-btn').forEach(btn => btn.classList.remove('selected'));
            
            // í˜„ì¬ ë²„íŠ¼ ì„ íƒ ìƒíƒœ ì„¤ì •
            button.classList.add('selected');
            selectedMethod = button.getAttribute('data-method');
            
            // ê²°ì œ ìˆ˜ë‹¨ ì„ íƒ ì‹œ ê²°ì œ ë²„íŠ¼ í™œì„±í™”
            document.querySelector('.confirm-payment-btn').disabled = false;
        }

        function processPayment() {
            if (!selectedMethod) {
                alert('ê²°ì œ ìˆ˜ë‹¨ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.');
                return;
            }
            
            let message = '';
            switch (selectedMethod) {
                case 'credit':
                    message = `[ì‹ ìš©ì¹´ë“œ] ${currentRequiredAmount.toLocaleString()}ì› ê²°ì œ í™”ë©´ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.`;
                    break;
                case 'check':
                    message = `[ì²´í¬ì¹´ë“œ] ${currentRequiredAmount.toLocaleString()}ì› ê²°ì œ í™”ë©´ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.`;
                    break;
                case 'cash':
                    message = `[í˜„ê¸ˆ ê²°ì œ] ${currentRequiredAmount.toLocaleString()}ì› ê³„ì¢Œ ì´ì²´ ì•ˆë‚´ í™”ë©´ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.`;
                    break;
            }

            // ì‹¤ì œ ê²°ì œ API í˜¸ì¶œ ëŒ€ì‹  ì•Œë¦¼ì°½ ì¶œë ¥
            alert(`ìƒí’ˆ: ${currentProductName}\nê²°ì œ ê¸ˆì•¡: ${currentRequiredAmount.toLocaleString()}ì›\n\n${message}`);

            // ê²°ì œ ì™„ë£Œ í›„ íŒì—… ë‹«ê¸° (ì‹¤ì œ êµ¬í˜„ ì‹œ API ì„±ê³µ í›„ ë‹«ì•„ì•¼ í•¨)
            closePaymentPopup();
        }

        // ë°°ê²½ í´ë¦­ ì‹œ íŒì—… ë‹«ê¸°
        popup.addEventListener('click', (e) => {
            if (e.target === popup) {
                closePaymentPopup();
            }
        });
    </script>
</body>
</html>